---
title: 通过固定概率事件获取任意概率事件
date: 2023-08-19 17:48:57
tags:
- 算法
- 数学
---

获取任意概率函数

<!--more-->

举个例子，有一枚硬币，抛出后正面朝上的概率为$q$，这个问题等价于如何通过多次抛一枚硬币获取概率为$p$的事件。

事实上，可以多次组合抛硬币事件来实现。下面我们的任务是组合多个事件让它们的概率之和等于$p$。设最终求出的事件族为S。

第一次抛，正面向上的概率是$q$，反面朝上的概率是$1-q$。如果$p\leq q$，接下来在正面朝上的情况下寻找概率和为$q$的事件族即可，相当于从第一次开始抛硬币，找出概率为$\frac{p}{q}$的事件，在反面朝上发生的情况下，由于反面朝上不可能再包括到我们的事件族中，因此返回False。如果$p>q$，那么正面向上这个事件已经在我们想要求的事件族中了，如果正面朝上直接返回True即可；在反面的情况下，需要继续寻找概率和为$p-a$的事件族，相当于从零开始抛硬币，找出概率为$\frac{p-q}{1-q}$的事件。

接下来递归即可。

测试代码:

```python
def toss_coin(p):
    """
    抛硬币，返回正面的概率为 p
    :param p:
    :return:
    """
    return lambda: random.random() < p


def get_prob(p, my_rand):
    if p <= q:
        if my_rand():
            return get_prob(p / q, my_rand)
        else:
            return False
    else:
        if my_rand():
            return True
        else:
            return get_prob((p - q) / (1 - q), my_rand)


def test(p):
    sum = 0
    N = int(1e7)
    for i in range(N):
        if get_prob(p, toss_coin(q)):
            sum += 1
    return sum / N


print(test(0.5))
```



